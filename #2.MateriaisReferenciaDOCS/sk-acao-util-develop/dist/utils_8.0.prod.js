"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function App(){var r={query:null,start:function(e){r.query=new Query,e(r),r.query.close()},selection:function(e){if(e)return new Record(linhas[0]);var t=new Array;return linhas.forEach(function(e){t.push(new Record(e))}),t},upperSelection:function(){return getLinhaPai},param:function(e){if("string"==typeof e)return getParam(e)?String(getParam(e)):""},systemParam:function(e){return getParametroSistema(e)},user:function(){return String(getUsuarioLogado())||""},javaImport:function(e){return newJava(e)},javaStaticImport:function(e){return javaClass(e)},alert:function(e){mensagem=e?e.toString():"[ VALOR INDEFINIDO ]"},error:function(e){mostraErro(String(e))},assert:function(e,t){return e||r.error(t),r},confirm:function(e,t){return confirmar(e,t,1),r},yesNo:function(e,t){return confirmarSimNao(e,t,1)},openPage:function(r){var n={};r.pk&&Object.keys(r.pk).forEach(function(e){n[e]=isNaN(r.pk[e])?r.pk[e]:"_"+String(r.pk[e])}),r.params&&(n.ACTION_PARAMETERS={},Object.keys(r.params).forEach(function(e,t){n[e]=isNaN(r.params[e])?r.params[e]:"_"+String(r.params[e]),n.ACTION_PARAMETERS[t]={fieldName:e,value:isNaN(r.params[e])?r.params[e]:"_"+String(r.params[e])}})),n.call_time=Date.now();var e=(e="/mge/system.jsp#app/%resID/%body&pk-refresh=%time").format({resID:Base64.encode(r.id),body:Base64.encode(JSON.stringify(n)),time:String(Date.now())});mensagem='<script id="autoClickLink">Object.assign (document.createElement ("a"), { target: "_top", href: "%url" }).click ();setTimeout (() =>document.getElementById ("autoClickLink").parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector ("div.modal-type-warning.modal.modal-message.sk-popup.ng-isolate-scope.in > div > div > div.modal-body").parentElement.querySelector ("button.btn-default").click (), 1000);<\/script>Confirme aqui a abertura da tela!'.format({url:e})},sendTxt:function(e){mensagem="<script>(function () {let msg     = '%msg';let number  = '%num';let ip      = '%ip';let port    = '%port';let session = '%sess';let url     = 'http://' + ip + ':' + port + '/sendText';(async () => {const response = await fetch (url, {method: 'POST',headers: {'Accept'        : 'application/json','Content-Type'  : 'application/json'},body: JSON.stringify ({sessionName : session,number      : number,text        : msg})});console.log (await response.json (););}) ();}) ();<\/script>%sec".format({ip:e.ip,port:e.port,sess:e.session,msg:e.message,num:e.number,sec:e.alert})}};return r}function Query(){var c={_query:null,params:{},select:function(e,t,r,n){if(null!=c._query){var a=new Array,o=(o=String()).add("SELECT %fields FROM %table ".format({fields:"string"==typeof t?t:t.join(", "),table:e}));for(n&&n.join&&(o=o.add(n.join)),r&&(o=o.add(" WHERE ").add(r)),c._query.nativeSelect(o.toString());c._query.next();)if("string"==typeof t)a.push(c._query.getString(t));else for(var i={},s=0;s<t.length;s++){var u=t[s];u.indexOf(".")<0?i[u]=c._query.getString(u):i[u.substr(u.indexOf(".")+1)]=c._query.getString(u.substr(u.indexOf(".")+1)),s==t.length-1&&a.push(i)}return a}mostraErro("Database unavailable. Try again later!")},selectOne:function(e,t,r,n){if(null!=c._query){var a={},o=(o=String()).add("SELECT %fields FROM %table ".format({fields:"string"==typeof t?t:t.join(", "),table:e}));for(n&&n.join&&(o=o.add(n.join)),r&&(o=o.add(" WHERE ").add(r)),c._query.nativeSelect(o);c._query.next();)if("string"==typeof t)a[t]=c._query.getString(t);else for(var i=0;i<t.length;i++){var s=t[i];s.indexOf(".")<0?a[s]=c._query.getString(s):a[s.substr(s.indexOf(".")+1)]=c._query.getString(s.substr(s.indexOf(".")+1))}return a}mostraErro("Database unavailable. Try again later!")},update:function(n,e,t){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],o=e,i=new Array,s=String("SELECT ").add("COUNT (*) AS DONE").add(" FROM ").add("ALL_TAB_COLUMNS").add(" WHERE ").add("TABLE_NAME = '%0'").add(" AND ").add("COLUMN_NAME = '%1'");if(null!=c._query){var u="".add("UPDATE ").add(n.toUpperCase()).add(" SET ");return Object.keys(o).forEach(function(e,t){var r=0;for(c._query.nativeSelect(s.format([n.toUpperCase(),e.toUpperCase()]));c._query.next();)r=Number(c._query.getString("DONE"));r<=0||a&&a.length&&-1<a.indexOf(e)||null==o[e]||null==o[e]?i.push(e):(u=u.add(e).add(" = "),u=String(o[e]).match(/([\d]{4})([-]{1})([\d]{2})([-]{1})([\d]{2})([ ]{1})([\d:]{8})/g)?u.add("TO_DATE ('").add(new Record(o).getDate(e)).add("', 'DD/MM/YYYY')"):u.add("string"==typeof o[e]?"'":"").add(o[e]).add("string"==typeof o[e]?"'":""),u=t===Object.keys(o).length-1-i.length?u.add(" "):u.add(", "))}),u.endsWith(", ")&&(u=u.substr(0,u.length-2).add(" ")),t?u=u.add("WHERE ").add(t):mostraErro("Prohibited INSERT/UPDATE operation without WHERE specific condition"),c._query.update(u),u="Record successfully update",i.length?u.add(" (Ignored fields: ").add(i.join(", ")).add(")."):u.add(".")}mostraErro("Database unavailable. Try again later!")},delete:function(e,t){var r=String("SELECT ").add("COUNT (*) AS DONE").add(" FROM ").add("USER_TABLES").add(" WHERE ").add("TABLE_NAME = '%table'"),n=0;if(null!=c._query){for(c._query.nativeSelect(r.format({table:e.toUpperCase()}));c._query.next();)n=Number(c._query.getString("DONE"));if(0<n){var a="".add("DELETE").add(" FROM ").add(e.toUpperCase());return t?a.add(" WHERE ").add(t):mostraErro("Prohibited DELETE operation without WHERE specific condition"),c._query.update(a),"Records from %table successfully deleted".format({table:e})}mostraErro("Table provided (%table) does not exists!".format({table:e}))}else mostraErro("Database unavailable. Try again later!")},set:function(e,t){if(c._query)switch(_typeof(e)){case"string":c.params[e]=t,c._query.setParam(e,t);break;case"object":e.length&&e.forEach(function(e){c.params[e]=t,c._query.setParam(e,t)})}return c},get:function(e){return!!c._query&&c.params[e]},execute:function(e){var t,r,n;0==e.indexOf("#DT=")?(r=(t=e.split("#"))[1].split("=")[1],(n=new Array).push("ALTER TABLE ".concat(r).concat(" DISABLE ALL TRIGGERS")),n.push(t[2]),n.push("ALTER TABLE ".concat(r).concat(" ENABLE ALL TRIGGERS")),n.forEach(function(e){e.length&&query.update(e)})):query.update(e)},close:function(){c._query.close()}};return c._query&&c._query.close(),c._query=getQuery(),c}function Record(t){var o={record:null,set:function(t,e){switch(_typeof(t)){case"string":o.record.setCampo?o.record.setCampo(t,e):o.record[t]=e,o[t]=e;break;case"object":if(t.length)for(var r=0;r<t.length;r++)o.record.setCampo?o.record.setCampo(t[r],e):o.record[t[r]]=e,o[t[r]]=e;else null==e&&Object.keys(t).forEach(function(e){o.record.setCampo?o.record.setCampo(e,t[e]):o.record[e]=t[e],o[e]=t[e]})}return o},get:function(e){var t=o.record&&o.record.getCampo?o.record.getCampo(e):o.record[e];return null!=t&&null!=t&&t},getDate:function(e){var t=String(o.get(e)),r=void 0;return t.match(/([0-9-]{10})/g)||t.match(/([0-9-]{10})[ ]{1}([0-9:.]{8,})/g)?r=new Date(t):mostraErro("Field must be a database date type!"),r},deleteParam:function(e){return o.record&&o.record.getCampo?o.record.setCampo(e,void 0):o.record[e]=void 0,o},save:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];if(o.record.save)o.record.save();else{if(e){var n=new Query,a=n.update(e,o.record,t,r);return n.close(),a}mostraErro("Provide the Table name to save dynamic objects")}return o},delete:function(e,t){if(o.record.remove)o.record.remove();else{if(e){var r=new Query,n=r.delete(e,t);return r.close(),n}mostraErro("Provide the Table name to delete dynamic objects")}return o}};return t?"string"==typeof t?o.record=novaLinha(t):(o.record=t,-1==Object.keys(t).indexOf("getClass")&&Object.keys(t).forEach(function(e){o.record[e]=t[e],o[e]=t[e]})):o.record=novaLinha(),o}String.prototype.format=function(t){var r=this.toString(),n="";return t&&t.toString().length?"string"==typeof t||"number"==typeof t?(n=r.match(/([%])([a-zA-Z]|[0-9])+/g)).forEach(function(e){r=r.toString().split(e).join(t.toString())}):Array.isArray(t)&&t.forEach(function(t){"string"==typeof t||"number"==typeof t?r=(n=r.match(/([%])([a-zA-Z]|[0-9])+/)[0])?r.split(n).join(String(t)):r:Object.keys(t).forEach(function(e){r=(n=r.match(new RegExp("(%)("+e+")","g"))[0])?r.split(n).join(String(t[e])):r})}):"object"==_typeof(t)&&Object.keys(t).forEach(function(e){r=(n=r.match(new RegExp("(%)("+e+")","g"))[0])?r.split("%"+e).join(String(t[e])):r}),r},String.prototype.add=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return this.toString()+e},Date.prototype.getArray=function(){var e=this.getMonth()+1,t=this.getDate(),r=new Array;return r.push(this.getFullYear()),r.push((9<e?"":"0")+e),r.push((9<t?"":"0")+t),r},Date.prototype.toSQLDate=function(){return this.toISOString().split(/[T]/)[0]+" "+d.toTimeString().split(/\s/)[0]},Object.prototype.equals=function(e){for(var t in this){if(_typeof(this[t])!==_typeof(e[t]))return!1;if(null===this[t]!=(null===e[t]))return!1;switch(_typeof(this[t])){case"undefined":if(void 0!==e[t])return!1;break;case"object":if(null!==this[t]&&null!==e[t]&&(this[t].constructor.toString()!==e[t].constructor.toString()||!this[t].equals(e[t])))return!1;break;case"function":if("equals"!=t&&this[t].toString()!=e[t].toString())return!1;break;default:if(this[t]!==e[t])return!1}}return!0},Array.prototype.reduce=function(e,t){for(var r="string"==typeof t?"":"number"==typeof t?0:{},n=0;n<this.length;n++)"string"!=typeof t&&"number"!=typeof t||(r=e(r,this[n],n,this));return r},Array.prototype.filter=function(n){var a=new Array;return this.forEach(function(e,t,r){n(e,t,r)&&a.push(e)}),a},Array.prototype.map=function(n){var a=new Array;return this.forEach(function(e,t,r){a.push(n(e,t,r))}),a};var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,n,a,o,i,s,u="",c=0;for(e=Base64._utf8_encode(e);c<e.length;)a=(t=e.charCodeAt(c++))>>2,o=(3&t)<<4|(r=e.charCodeAt(c++))>>4,i=(15&r)<<2|(n=e.charCodeAt(c++))>>6,s=63&n,isNaN(r)?i=s=64:isNaN(n)&&(s=64),u=u+Base64._keyStr.charAt(a)+Base64._keyStr.charAt(o)+Base64._keyStr.charAt(i)+Base64._keyStr.charAt(s);return u},decode:function(e){var t,r,n,a,o,i,s="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)t=Base64._keyStr.indexOf(e.charAt(u++))<<2|(a=Base64._keyStr.indexOf(e.charAt(u++)))>>4,r=(15&a)<<4|(o=Base64._keyStr.indexOf(e.charAt(u++)))>>2,n=(3&o)<<6|(i=Base64._keyStr.indexOf(e.charAt(u++))),s+=String.fromCharCode(t),64!=o&&(s+=String.fromCharCode(r)),64!=i&&(s+=String.fromCharCode(n));return s=Base64._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t,r,n,a="",o=0;o<e.length;)(t=e.charCodeAt(o))<128?(a+=String.fromCharCode(t),o++):191<t&&t<224?(r=e.charCodeAt(o+1),a+=String.fromCharCode((31&t)<<6|63&r),o+=2):(r=e.charCodeAt(o+1),n=e.charCodeAt(o+2),a+=String.fromCharCode((15&t)<<12|(63&r)<<6|63&n),o+=3);return a}},JSON={stringify:function(e){var t,r,n,a=e instanceof Array,o=["equals"];if("object"!==_typeof(e)){if("string"==typeof e)return'"%0"'.format(e);if("number"==typeof e)return e.toString()}for(t in r=a?"[":"{",e)o.indexOf(t.toString())<0&&(a||(r+=JSON._quote(t)+": "),r+="object"===_typeof(n=e[t])?JSON.stringify(n):JSON._quote(n),r+=", ");return r=r.substr(0,1<r.length?r.length-2:r.length)+(a?"]":"}")},_quote:function(e){return"string"!=typeof e&&(e=e.toString()),e=e.match(/^\".*\"$/)?e:'"'+e.replace(/"/g,'\\"')+'"',isNaN(e.replace(/^["]/,"").replace(/["]$/,""))?e.replace(/^["]/,"").replace(/["]$/,"").startsWith("_")&&!isNaN(e.replace(/^["]/,"").replace(/["]$/,"").replace("_",""))?e.replace("_",""):e:e.replace(/^["]/,"").replace(/["]$/,"")}};
