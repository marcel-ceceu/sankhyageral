<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Financeiro - Mock Sankhya</title>
  <!--
    GUIA RÁPIDO (aprendizados + regras para próximas versões)
    1) HTML + JS devem usar os MESMOS IDs (ex.: searchInput, filterStatus, filterVendedor, btnAtualizar, btnExportar, pageInput, pageSize, tableBody).
    2) data-column no <th> deve bater com getColumnValue() no JS.
    3) A query SQL precisa retornar TODOS os campos usados no renderTable/KPIs.
    4) Sempre normalizar chaves do retorno (NUNOTA vs nunota) para não quebrar.
    5) Em produção: remover mock e consultar via JX (com tratamento de erro limpando a tela).
    6) Para overlays, use .hidden { display: none !important; } (evita conflito de especificidade).
    7) SankhyaJX pode estar em window, parent ou top (ambiente embutido).
    8) pageSize default do estado deve refletir o <select> marcado.
  -->
  <style>
    /* ===== CSS VARIABLES - DESIGN TOKENS ===== */
    :root {
      --background: hsl(0 0% 100%);
      --foreground: hsl(222.2 84% 4.9%);
      --muted: hsl(210 40% 96.1%);
      --muted-foreground: hsl(215.4 16.3% 46.9%);
      --border: hsl(214.3 31.8% 91.4%);
      --primary: hsl(221.2 83.2% 53.3%);
      --primary-foreground: hsl(210 40% 98%);
      --card: hsl(0 0% 100%);
      --card-foreground: hsl(222.2 84% 4.9%);
      --success: hsl(142 76% 36%);
      --success-bg: hsl(142 76% 94%);
      --warning: hsl(38 92% 50%);
      --warning-bg: hsl(38 92% 94%);
      --destructive: hsl(0 84% 60%);
      --destructive-bg: hsl(0 84% 94%);
      --info: hsl(221 83% 53%);
      --info-bg: hsl(221 83% 94%);
      --radius: 0.5rem;
      --font-sans: ui-sans-serif, system-ui, sans-serif;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-sans);
      background: var(--muted);
      color: var(--foreground);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ===== STATUS CARDS (KPIs) ===== */
    .status-cards {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 0.75rem;
      padding: 1rem;
      background: var(--card);
      border-bottom: 1px solid var(--border);
    }

    .status-card {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem;
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    .status-card.total { background: var(--info-bg); border-color: hsl(221 83% 85%); }
    .status-card.receitas { background: var(--success-bg); border-color: hsl(142 76% 85%); }
    .status-card.despesas { background: var(--destructive-bg); border-color: hsl(0 84% 85%); }
    .status-card.aberto { background: var(--warning-bg); border-color: hsl(38 92% 85%); }
    .status-card.vencido { background: var(--destructive-bg); border-color: hsl(0 84% 85%); }
    .status-card.pago { background: var(--success-bg); border-color: hsl(142 76% 85%); }

    .status-card-icon {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: calc(var(--radius) - 2px);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .status-card.total .status-card-icon { background: var(--info); color: white; }
    .status-card.receitas .status-card-icon { background: var(--success); color: white; }
    .status-card.despesas .status-card-icon { background: var(--destructive); color: white; }
    .status-card.aberto .status-card-icon { background: var(--warning); color: white; }
    .status-card.vencido .status-card-icon { background: var(--destructive); color: white; }
    .status-card.pago .status-card-icon { background: var(--success); color: white; }

    .status-card-icon svg {
      width: 1.25rem;
      height: 1.25rem;
    }

    .status-card-content {
      min-width: 0;
    }

    .status-card-label {
      font-size: 0.625rem;
      font-weight: 500;
      color: var(--muted-foreground);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.125rem;
    }

    .status-card-value {
      font-size: 1rem;
      font-weight: 700;
      color: var(--foreground);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .status-card.receitas .status-card-value { color: var(--success); }
    .status-card.despesas .status-card-value { color: var(--destructive); }

    /* ===== TOOLBAR / FILTROS ===== */
    .toolbar {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      background: var(--card);
      border-bottom: 1px solid var(--border);
      flex-wrap: wrap;
    }

    .toolbar-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--foreground);
    }

    .toolbar-title svg {
      width: 1.25rem;
      height: 1.25rem;
      color: var(--primary);
    }

    .toolbar-spacer {
      flex: 1;
    }

    .search-input {
      position: relative;
      width: 280px;
    }

    .search-input input {
      width: 100%;
      height: 2rem;
      padding: 0 0.75rem 0 2.25rem;
      font-size: 0.75rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--background);
      color: var(--foreground);
    }

    .search-input input:focus {
      outline: 2px solid var(--primary);
      outline-offset: -1px;
    }

    .search-input svg {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      width: 0.875rem;
      height: 0.875rem;
      color: var(--muted-foreground);
    }

    .filter-select {
      height: 2rem;
      padding: 0 0.75rem;
      font-size: 0.75rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--background);
      color: var(--foreground);
      cursor: pointer;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.375rem;
      height: 2rem;
      padding: 0 0.75rem;
      font-size: 0.75rem;
      font-weight: 500;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--background);
      color: var(--foreground);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .btn:hover:not(:disabled) {
      background: var(--muted);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn svg {
      width: 0.875rem;
      height: 0.875rem;
    }

    .btn-primary {
      background: var(--primary);
      border-color: var(--primary);
      color: var(--primary-foreground);
    }

    .btn-primary:hover {
      background: hsl(221.2 83.2% 48%);
    }

    /* ===== TABLE ===== */
    .table-container {
      flex: 1;
      overflow: auto;
      background: var(--card);
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.875rem;
    }

    .table th,
    .table td {
      padding: 0.625rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
      white-space: nowrap;
    }

    .table th {
      background: var(--muted);
      font-weight: 600;
      color: var(--foreground);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .table-header-cell {
      display: flex;
      align-items: center;
      gap: 0.375rem;
      cursor: pointer;
      user-select: none;
    }

    .table-header-cell:hover {
      color: var(--primary);
    }

    .filter-icon {
      width: 0.75rem;
      height: 0.75rem;
      color: var(--muted-foreground);
      opacity: 0;
      transition: opacity 0.15s;
    }

    .table th:hover .filter-icon {
      opacity: 1;
    }

    .table th {
      position: relative;
    }

    .resize-handle {
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      cursor: col-resize;
      background: transparent;
    }

    .resize-handle:hover,
    .resize-handle.active {
      background: var(--primary);
    }

    .table tbody tr:nth-child(even) {
      background: hsl(210 40% 98%);
    }

    .table tbody tr:hover {
      background: hsl(210 40% 96%);
    }

    .table tbody tr.selected {
      background: hsl(221 83% 94%) !important;
    }

    .table tbody tr.paid-row {
      opacity: 0.6;
    }

    .table tbody tr.paid-row td {
      text-decoration: line-through;
      text-decoration-color: var(--muted-foreground);
    }

    .table tbody tr {
      border-left: 3px solid transparent;
    }

    .table tbody tr.receita-row {
      border-left-color: var(--success);
    }

    .table tbody tr.despesa-row {
      border-left-color: var(--destructive);
    }

    /* ===== CHECKBOX ===== */
    .checkbox {
      width: 1rem;
      height: 1rem;
      border: 1px solid var(--primary);
      border-radius: 0.25rem;
      appearance: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background);
    }

    .checkbox:checked {
      background: var(--primary);
    }

    .checkbox:checked::after {
      content: '';
      width: 0.5rem;
      height: 0.5rem;
      background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'/%3E%3C/svg%3E") center/contain no-repeat;
    }

    /* ===== STATUS BADGES ===== */
    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.25rem 0.5rem;
      font-size: 0.75rem;
      font-weight: 600;
      border-radius: 9999px;
      text-transform: uppercase;
      letter-spacing: 0.025em;
    }

    .badge-pago { background: var(--success-bg); color: var(--success); }
    .badge-pendente { background: var(--warning-bg); color: hsl(38 92% 40%); }
    .badge-vencido { background: var(--destructive-bg); color: var(--destructive); }

    /* ===== REC/DESP TAGS ===== */
    .tag-recdesp {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.5rem;
      font-size: 0.625rem;
      font-weight: 600;
      border-radius: 0.25rem;
    }

    .tag-receita { background: var(--success-bg); color: var(--success); }
    .tag-despesa { background: var(--destructive-bg); color: var(--destructive); }

    .tag-recdesp svg {
      width: 0.625rem;
      height: 0.625rem;
    }

    /* ===== AVATAR / PARTNER ===== */
    .partner-cell {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .avatar {
      width: 1.875rem;
      height: 1.875rem;
      border-radius: 0.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.625rem;
      font-weight: 700;
      color: white;
      flex-shrink: 0;
    }

    /* ===== SELEÇÃO ===== */
    .selection-count {
      font-size: 0.75rem;
      color: var(--muted-foreground);
    }

    /* ===== COLUMN FILTER DROPDOWN ===== */
    .column-filter-dropdown {
      position: absolute;
      min-width: 220px;
      background: var(--background);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      z-index: 999;
      padding: 0.5rem;
      display: none;
    }

    .column-filter-dropdown.open {
      display: block;
    }

    .column-filter-actions,
    .column-filter-selectors {
      display: flex;
      gap: 0.5rem;
    }

    .column-filter-actions {
      margin-bottom: 0.5rem;
    }

    .column-filter-search {
      margin-bottom: 0.5rem;
    }

    .column-filter-search input {
      width: 100%;
      height: 1.75rem;
      padding: 0 0.5rem;
      font-size: 0.75rem;
      border: 1px solid var(--border);
      border-radius: calc(var(--radius) - 2px);
      background: var(--background);
      color: var(--foreground);
    }

    .column-filter-list {
      max-height: 220px;
      overflow: auto;
      margin-top: 0.5rem;
      padding-right: 0.25rem;
    }

    .column-filter-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.25rem 0.25rem;
      font-size: 0.75rem;
      color: var(--foreground);
    }

    .column-filter-item input {
      width: 0.875rem;
      height: 0.875rem;
    }

    .btn-small {
      height: 1.5rem;
      padding: 0 0.5rem;
      font-size: 0.6875rem;
    }

    .partner-name {
      font-weight: 500;
      color: var(--foreground);
    }

    /* ===== CURRENCY VALUES ===== */
    .value-positive { color: var(--success); font-weight: 600; }
    .value-negative { color: var(--destructive); font-weight: 600; }

    /* ===== DICA APRENDIDA: overlay de loading =====
       Use .hidden com !important para vencer o display do overlay. */
    .hidden { display: none !important; }

    /* ===== TIPO TITULO ===== */
    .tipo-titulo-cell {
      display: flex;
      align-items: center;
      gap: 0.375rem;
    }

    .tipo-titulo-icon {
      width: 1.25rem;
      height: 1.25rem;
      border-radius: 0.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .tipo-titulo-icon svg {
      width: 0.75rem;
      height: 0.75rem;
    }

    .tipo-boleto .tipo-titulo-icon { background: hsl(142 76% 94%); color: hsl(142 76% 36%); }
    .tipo-pix .tipo-titulo-icon { background: hsl(172 66% 94%); color: hsl(172 66% 36%); }
    .tipo-cartao .tipo-titulo-icon { background: hsl(262 83% 94%); color: hsl(262 83% 48%); }
    .tipo-dinheiro .tipo-titulo-icon { background: hsl(142 76% 94%); color: hsl(142 76% 36%); }
    .tipo-cheque .tipo-titulo-icon { background: hsl(215 16% 94%); color: hsl(215 16% 47%); }
    .tipo-promissoria .tipo-titulo-icon { background: hsl(38 92% 94%); color: hsl(38 92% 40%); }
    .tipo-credito .tipo-titulo-icon { background: hsl(262 83% 94%); color: hsl(262 83% 48%); }

    /* ===== PAGINATION BAR ===== */
    .pagination-bar {
      flex-shrink: 0;
      border-top: 1px solid var(--border);
      background: hsl(210 40% 96.1% / 0.3);
      padding: 0.375rem 0.75rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.75rem;
    }

    .record-info {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--muted-foreground);
    }

    .record-info .highlight {
      font-weight: 500;
      color: var(--foreground);
    }

    .pagination-controls {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .btn-icon {
      width: 1.75rem;
      height: 1.75rem;
      padding: 0;
      border: none;
      background: transparent;
      border-radius: calc(var(--radius) - 2px);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s ease;
    }

    .btn-icon:hover:not(:disabled) {
      background: hsl(210 40% 96.1%);
    }

    .btn-icon:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-icon svg {
      width: 1rem;
      height: 1rem;
    }

    .page-indicator {
      display: flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0 0.5rem;
      margin: 0 0.25rem;
      background: var(--background);
      border-radius: calc(var(--radius) - 2px);
      border: 1px solid var(--border);
    }

    .page-indicator span {
      color: var(--muted-foreground);
    }

    .page-indicator .current-page {
      font-weight: 500;
      color: var(--foreground);
    }

    .page-input {
      width: 3.5rem;
      height: 1.5rem;
      font-size: 0.75rem;
      text-align: center;
      padding: 0.25rem;
      border: none;
      background: transparent;
      color: var(--foreground);
      font-family: inherit;
    }

    .page-input:focus {
      outline: none;
    }

    .page-size-container {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .page-size-select {
      height: 1.75rem;
      width: 5rem;
      font-size: 0.75rem;
      padding: 0 0.5rem;
      border: 1px solid var(--border);
      border-radius: calc(var(--radius) - 2px);
      background: var(--background);
      color: var(--foreground);
      cursor: pointer;
      font-family: inherit;
    }

    .page-size-select:focus {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .page-size-label {
      color: var(--muted-foreground);
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 1024px) {
      .status-cards {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 640px) {
      .status-cards {
        grid-template-columns: repeat(2, 1fr);
      }
      .toolbar {
        flex-direction: column;
        align-items: stretch;
      }
      .search-input {
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <!-- ===== STATUS CARDS (KPIs) ===== -->
  <div class="status-cards">
    <div class="status-card total">
      <div class="status-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
          <path d="M15 2H9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1Z"/>
        </svg>
      </div>
      <div class="status-card-content">
        <div class="status-card-label">Total Geral</div>
        <div class="status-card-value">R$ 146.072,92</div>
      </div>
    </div>
    <div class="status-card receitas">
      <div class="status-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
        </svg>
      </div>
      <div class="status-card-content">
        <div class="status-card-label">Receitas (760)</div>
        <div class="status-card-value">R$ 141.759,85</div>
      </div>
    </div>
    <div class="status-card despesas">
      <div class="status-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
        </svg>
      </div>
      <div class="status-card-content">
        <div class="status-card-label">Despesas (40)</div>
        <div class="status-card-value">R$ 4.313,07</div>
      </div>
    </div>
    <div class="status-card aberto">
      <div class="status-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12 6 12 12 16 14"/>
        </svg>
      </div>
      <div class="status-card-content">
        <div class="status-card-label">Em Aberto (270)</div>
        <div class="status-card-value">R$ 73.860,46</div>
      </div>
    </div>
    <div class="status-card vencido">
      <div class="status-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
          <line x1="12" y1="9" x2="12" y2="13"/>
          <line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
      </div>
      <div class="status-card-content">
        <div class="status-card-label">Vencidos (236)</div>
        <div class="status-card-value">R$ 28.846,76</div>
      </div>
    </div>
    <div class="status-card pago">
      <div class="status-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
      </div>
      <div class="status-card-content">
        <div class="status-card-label">Pagos (294)</div>
        <div class="status-card-value">R$ 43.365,70</div>
      </div>
    </div>
  </div>

  <!-- ===== TOOLBAR / FILTROS ===== -->
  <!-- REGRA: IDs dos inputs/selects precisam existir no JS -->
  <div class="toolbar">
    <div class="toolbar-title">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
      </svg>
      <span>Dados do banco de dados</span>
    </div>
    <div class="toolbar-spacer"></div>
    <div class="search-input">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.3-4.3"/>
      </svg>
      <!-- DICA: manter ID alinhado com o JS (ex.: searchInput) -->
      <input type="text" placeholder="Buscar parceiro, código, nota...">
    </div>
    <!-- DICA: manter ID alinhado com o JS (ex.: filterStatus) -->
    <select class="filter-select">
      <option value="">Todos</option>
      <option value="pendente">Pendente</option>
      <option value="vencido">Vencido</option>
      <option value="pago">Pago</option>
    </select>
    <!-- DICA: manter ID alinhado com o JS (ex.: filterVendedor) -->
    <select class="filter-select">
      <option value="">Todos</option>
      <option value="receita">Receita</option>
      <option value="despesa">Despesa</option>
    </select>
    <span class="selection-count" id="selectionCount">0 selecionado(s)</span>
    <button class="btn" id="clearSelection" disabled>Limpar seleção</button>
    <button class="btn">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
      Importar CSV
    </button>
    <button class="btn">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 3v18h18"/>
        <path d="m19 9-5 5-4-4-3 3"/>
      </svg>
      Exp
    </button>
    <button class="btn">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="7" height="7"/>
        <rect x="14" y="3" width="7" height="7"/>
        <rect x="14" y="14" width="7" height="7"/>
        <rect x="3" y="14" width="7" height="7"/>
      </svg>
      Colunas (14)
    </button>
  </div>

  <!-- ===== TABLE ===== -->
  <!-- REGRA: data-column deve casar com getColumnValue() -->
  <div class="table-container">
    <table class="table" id="dataTable">
      <thead>
        <tr>
          <th style="width: 40px;"><input type="checkbox" class="checkbox" id="selectAll"></th>
          <th style="width: 80px;" data-column="status">
            <div class="table-header-cell">Status
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 90px;" data-column="nufin">
            <div class="table-header-cell">Nº Financ.
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 80px;" data-column="nunota">
            <div class="table-header-cell">Nº Nota
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 80px;" data-column="codparc">
            <div class="table-header-cell">Cód. Parc.
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 220px;" data-column="parceiro">
            <div class="table-header-cell">Parceiro
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 150px;" data-column="tipo">
            <div class="table-header-cell">Tipo Título
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 100px;" data-column="vencimento">
            <div class="table-header-cell">Vencimento
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 100px;" data-column="negociacao">
            <div class="table-header-cell">Negociação
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 100px;" data-column="dhbaixa">
            <div class="table-header-cell">Data Baixa
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 100px;" data-column="valor">
            <div class="table-header-cell">Valor
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 80px;" data-column="recdesp">
            <div class="table-header-cell">Rec/D...
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 150px;" data-column="natureza">
            <div class="table-header-cell">Natureza
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 150px;" data-column="descricao">
            <div class="table-header-cell">Descrição
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
          <th style="width: 80px;" data-column="origem">
            <div class="table-header-cell">Origem
              <svg class="filter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
            </div>
            <div class="resize-handle"></div>
          </th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <!-- Dados serão inseridos via JS no Bloco 2 -->
      </tbody>
    </table>
  </div>

  <!-- ===== COLUMN FILTER DROPDOWN ===== -->
  <div class="column-filter-dropdown" id="columnFilterDropdown">
    <div class="column-filter-actions">
      <button class="btn btn-small" type="button" data-sort="asc">A-Z</button>
      <button class="btn btn-small" type="button" data-sort="desc">Z-A</button>
    </div>
    <div class="column-filter-search">
      <input type="text" id="columnFilterSearch" placeholder="Buscar...">
    </div>
    <div class="column-filter-selectors">
      <button class="btn btn-small" type="button" data-select="all">Todos</button>
      <button class="btn btn-small" type="button" data-select="none">Nenhum</button>
    </div>
    <div class="column-filter-list" id="columnFilterList"></div>
  </div>

  <!-- ===== PAGINATION BAR ===== -->
  <div class="pagination-bar">
    <div class="record-info">
      <span>Mostrando <span class="highlight" id="recordStart">1</span> - <span class="highlight" id="recordEnd">800</span> de <span class="highlight" id="recordTotal">800</span></span>
    </div>
    <div class="pagination-controls">
      <button class="btn-icon" id="btnFirst" title="Primeira página (Alt+Home)" disabled>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="11 17 6 12 11 7"></polyline>
          <polyline points="18 17 13 12 18 7"></polyline>
        </svg>
      </button>
      <button class="btn-icon" id="btnPrev" title="Página anterior (Alt+←)" disabled>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <div class="page-indicator">
        <span>Página</span>
        <input type="number" class="page-input" id="pageInput" value="1" min="1" max="1">
        <span>de</span>
        <span class="current-page" id="totalPages">1</span>
      </div>
      <button class="btn-icon" id="btnNext" title="Próxima página (Alt+→)">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
      <button class="btn-icon" id="btnLast" title="Última página (Alt+End)">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="13 17 18 12 13 7"></polyline>
          <polyline points="6 17 11 12 6 7"></polyline>
        </svg>
      </button>
    </div>
    <div class="page-size-container">
      <select class="page-size-select" id="pageSize">
        <option value="200">200</option>
        <option value="500">500</option>
        <option value="800" selected>800</option>
        <option value="1000">1000</option>
      </select>
      <span class="page-size-label">por página</span>
    </div>
  </div>

  <!-- DICA: quando for usar JX, inclua a lib antes deste script.
       Ex.: <script src="https://cdn.jsdelivr.net/gh/wansleynery/SankhyaJX/jx.min.js"></script> -->
  <script>
    // =============================================
    // DASHBOARD FINANCEIRO - ES5 COMPATÍVEL
    // =============================================
    // DICA: em ambiente Sankhya embed, JX pode estar em window.parent ou window.top.

    // ===== DADOS MOCK (baseado na imagem) =====
    // APRENDIDO: remover mocks em produção e carregar via JX.consultar().
    // REGRA: normalizar chaves do retorno (NUNOTA vs nunota).
    var mockData = [
      { status: 'Pendente', nufin: 125296, nunota: 104915, codparc: 3487, parceiro: 'MARCIANO PREVIATTELI DA SILVA', iniciais: 'MS', cor: 'hsl(280, 70%, 50%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 380.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Pendente', nufin: 125293, nunota: 104945, codparc: 3487, parceiro: 'MARCIANO PREVIATTELI DA SILVA', iniciais: 'MS', cor: 'hsl(280, 70%, 50%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 135.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Vencido', nufin: 125292, nunota: 104944, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 16.00, recdesp: 'Rec', natureza: '<SEM NATUREZA>', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Vencido', nufin: 125290, nunota: 104941, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 4.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pendente', nufin: 125286, nunota: 104939, codparc: 50, parceiro: 'CARLOS ROBERTO FABRINI (B...', iniciais: 'CR', cor: 'hsl(340, 70%, 50%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 220.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Vencido', nufin: 125276, nunota: 104937, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 80.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Vencido', nufin: 125275, nunota: 104936, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 8.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Vencido', nufin: 125274, nunota: 104935, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 56.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Vencido', nufin: 125272, nunota: 104934, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 124.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Vencido', nufin: 125271, nunota: 104933, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 160.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Vencido', nufin: 125270, nunota: 104932, codparc: 3487, parceiro: 'MARCIANO PREVIATTELI DA SI...', iniciais: 'MS', cor: 'hsl(280, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 25.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Vencido', nufin: 125269, nunota: 104931, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 41.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pendente', nufin: 125243, nunota: 104929, codparc: 1892, parceiro: 'VL COMERCIO DE PECAS LTDA', iniciais: 'VL', cor: 'hsl(120, 60%, 40%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 25.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Pago', nufin: 125240, nunota: 104927, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 80.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pendente', nufin: 125239, nunota: 104926, codparc: 26, parceiro: 'LEANDRO DIAS PRADO', iniciais: 'LP', cor: 'hsl(45, 90%, 45%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 120.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Pago', nufin: 125238, nunota: 104925, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 8.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pago', nufin: 125236, nunota: 104923, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 50.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pago', nufin: 125234, nunota: 104921, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 184.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pago', nufin: 125233, nunota: 104920, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 190.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pendente', nufin: 125232, nunota: 104919, codparc: 3487, parceiro: 'MARCIANO PREVIATTELI DA SI...', iniciais: 'MS', cor: 'hsl(280, 70%, 50%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 39.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Pendente', nufin: 125231, nunota: 104918, codparc: 192, parceiro: 'DARIO ANTONIO STOCCO', iniciais: 'DS', cor: 'hsl(15, 80%, 50%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 320.50, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Pendente', nufin: 125229, nunota: 104917, codparc: 658, parceiro: 'JEAM LUIZ PIVETTA', iniciais: 'JP', cor: 'hsl(180, 60%, 40%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 1594.50, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Pago', nufin: 125225, nunota: 104914, codparc: 12000, parceiro: 'CONSUMIDOR FINAL', iniciais: 'CF', cor: 'hsl(200, 70%, 50%)', tipo: 'DINHEIRO - EE', tipoClass: 'dinheiro', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 41.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CAIXINHA APSP', origem: 'E' },
      { status: 'Pendente', nufin: 125220, nunota: 104911, codparc: 3360, parceiro: 'OSMAR ANTUNES DE LIMA 33...', iniciais: 'OA', cor: 'hsl(60, 70%, 40%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 101.00, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' },
      { status: 'Vencido', nufin: 125216, nunota: 4799, codparc: 1093, parceiro: 'LUIZ DA SILVA ROCHA', iniciais: 'LR', cor: 'hsl(320, 60%, 45%)', tipo: 'CREDITO CEDIDO -...', tipoClass: 'credito', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '', valor: 47.00, recdesp: 'Desp', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDITO A PAGAR P/ TERCEI...', origem: 'E' },
      { status: 'Pago', nufin: 125212, nunota: 4798, codparc: 3770, parceiro: 'ROBERTO LOPES', iniciais: 'RL', cor: 'hsl(240, 60%, 50%)', tipo: 'CREDITO CEDIDO -...', tipoClass: 'credito', vencimento: '23/01/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 93.00, recdesp: 'Desp', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDITO A PAGAR P/ TERCEI...', origem: 'E' },
      { status: 'Pago', nufin: 125210, nunota: 32549, codparc: 289, parceiro: 'GIOVANI GODOI', iniciais: 'GG', cor: 'hsl(100, 50%, 40%)', tipo: 'PROMISSORIA A RE...', tipoClass: 'promissoria', vencimento: '22/02/2026', negociacao: '23/01/2026', dhbaixa: '23/01/2026', valor: 144.43, recdesp: 'Rec', natureza: 'VENDA DE PRODUTOS', descricao: 'CREDIARIO FISICO', origem: 'E' }
    ];

    // ===== ESTADO DA PAGINAÇÃO =====
    // REGRA: pageSize deve bater com o <select> marcado no HTML.
    var state = {
      currentPage: 1,
      pageSize: 800,
      totalCount: mockData.length,
      totalPages: 1
    };

    // ===== ELEMENTOS DO DOM =====
    // REGRA: IDs precisam existir no HTML (senão o JS quebra).
    var tableBody = document.getElementById('tableBody');
    var selectAllCheckbox = document.getElementById('selectAll');
    var pageInput = document.getElementById('pageInput');
    var pageSizeSelect = document.getElementById('pageSize');
    var btnFirst = document.getElementById('btnFirst');
    var btnPrev = document.getElementById('btnPrev');
    var btnNext = document.getElementById('btnNext');
    var btnLast = document.getElementById('btnLast');
    var recordStart = document.getElementById('recordStart');
    var recordEnd = document.getElementById('recordEnd');
    var recordTotal = document.getElementById('recordTotal');
    var totalPagesEl = document.getElementById('totalPages');
    var selectionCountEl = document.getElementById('selectionCount');
    var clearSelectionBtn = document.getElementById('clearSelection');
    var columnFilterDropdown = document.getElementById('columnFilterDropdown');
    var columnFilterList = document.getElementById('columnFilterList');
    var columnFilterSearch = document.getElementById('columnFilterSearch');

    // ===== ESTADO DE FILTRO =====
    // DICA: filtros de coluna precisam dos mesmos data-column do <th>.
    var filteredData = mockData.slice();
    var columnFilters = {};
    var activeFilterColumn = null;
    var activeFilterHeader = null;

    // ===== FUNÇÕES AUXILIARES =====
    // DICA: formatCurrency assume número; sanitize antes se vier string.
    function formatCurrency(value) {
      return value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function getBadgeClass(status) {
      if (status === 'Pago') return 'badge-pago';
      if (status === 'Vencido') return 'badge-vencido';
      return 'badge-pendente';
    }

    function getTipoTituloIcon(tipoClass) {
      var icons = {
        dinheiro: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/></svg>',
        promissoria: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg>',
        credito: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>',
        boleto: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2"/><path d="M7 8h2v8H7z"/><path d="M11 8h1v8h-1z"/><path d="M15 8h2v8h-2z"/></svg>',
        pix: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5M2 12l10 5 10-5"/></svg>'
      };
      return icons[tipoClass] || icons.dinheiro;
    }

    function getRecDespTag(recdesp) {
      if (recdesp === 'Rec') {
        return '<span class="tag-recdesp tag-receita">' +
          '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m18 15-6-6-6 6"/></svg>' +
          'Rec</span>';
      } else {
        return '<span class="tag-recdesp tag-despesa">' +
          '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 9 6 6 6-6"/></svg>' +
          'Desp</span>';
      }
    }

    // ===== RENDERIZAR TABELA =====
    function renderTable() {
      var startIndex = (state.currentPage - 1) * state.pageSize;
      var endIndex = Math.min(startIndex + state.pageSize, state.totalCount);
      var pageData = filteredData.slice(startIndex, endIndex);

      var html = '';
      for (var i = 0; i < pageData.length; i++) {
        var row = pageData[i];
        var isPago = row.status === 'Pago';
        var isReceita = row.recdesp === 'Rec';
        
        var rowClass = isReceita ? 'receita-row' : 'despesa-row';
        if (isPago) rowClass += ' paid-row';

        var valorPrefix = isReceita ? '+R$ ' : '-R$ ';
        var valorClass = isReceita ? 'value-positive' : 'value-negative';

        html += '<tr class="' + rowClass + '">';
        html += '<td><input type="checkbox" class="checkbox row-checkbox"></td>';
        html += '<td><span class="badge ' + getBadgeClass(row.status) + '">' + row.status + '</span></td>';
        html += '<td>' + row.nufin + '</td>';
        html += '<td>' + row.nunota + '</td>';
        html += '<td>' + row.codparc + '</td>';
        html += '<td><div class="partner-cell">';
        html += '<div class="avatar" style="background-color: ' + row.cor + ';">' + row.iniciais + '</div>';
        html += '<span class="partner-name">' + row.parceiro + '</span>';
        html += '</div></td>';
        html += '<td><div class="tipo-titulo-cell tipo-' + row.tipoClass + '">';
        html += '<div class="tipo-titulo-icon">' + getTipoTituloIcon(row.tipoClass) + '</div>';
        html += '<span>' + row.tipo + '</span>';
        html += '</div></td>';
        html += '<td>' + row.vencimento + '</td>';
        html += '<td>' + row.negociacao + '</td>';
        html += '<td>' + (row.dhbaixa || '-') + '</td>';
        html += '<td><span class="' + valorClass + '">' + valorPrefix + formatCurrency(row.valor) + '</span></td>';
        html += '<td>' + getRecDespTag(row.recdesp) + '</td>';
        html += '<td>' + row.natureza + '</td>';
        html += '<td>' + row.descricao + '</td>';
        html += '<td>' + row.origem + '</td>';
        html += '</tr>';
      }

      tableBody.innerHTML = html;
      bindRowCheckboxes();
      updateSelectAllState();
    }

    // ===== ATUALIZAR PAGINAÇÃO =====
    function updatePagination() {
      state.totalPages = Math.ceil(state.totalCount / state.pageSize);
      if (state.totalPages < 1) state.totalPages = 1;
      if (state.currentPage > state.totalPages) state.currentPage = state.totalPages;

      var startRecord = state.totalCount === 0 ? 0 : (state.currentPage - 1) * state.pageSize + 1;
      var endRecord = state.totalCount === 0 ? 0 : Math.min(state.currentPage * state.pageSize, state.totalCount);

      recordStart.textContent = startRecord.toLocaleString('pt-BR');
      recordEnd.textContent = endRecord.toLocaleString('pt-BR');
      recordTotal.textContent = state.totalCount.toLocaleString('pt-BR');

      pageInput.value = state.currentPage;
      pageInput.max = state.totalPages;
      totalPagesEl.textContent = state.totalPages;

      btnFirst.disabled = state.currentPage === 1;
      btnPrev.disabled = state.currentPage === 1;
      btnNext.disabled = state.currentPage === state.totalPages;
      btnLast.disabled = state.currentPage === state.totalPages;
    }

    // ===== NAVEGAÇÃO =====
    function goToPage(page) {
      var newPage = Math.max(1, Math.min(page, state.totalPages));
      if (newPage !== state.currentPage) {
        state.currentPage = newPage;
        updatePagination();
        renderTable();
      }
    }

    function goToFirst() { goToPage(1); }
    function goToPrev() { goToPage(state.currentPage - 1); }
    function goToNext() { goToPage(state.currentPage + 1); }
    function goToLast() { goToPage(state.totalPages); }

    // ===== CHECKBOX SELECT ALL =====
    function bindRowCheckboxes() {
      var rowCheckboxes = document.querySelectorAll('.row-checkbox');
      for (var i = 0; i < rowCheckboxes.length; i++) {
        rowCheckboxes[i].addEventListener('change', function() {
          var row = this.closest('tr');
          if (row) {
            if (this.checked) {
              row.classList.add('selected');
            } else {
              row.classList.remove('selected');
            }
          }
          updateSelectAllState();
        });
      }
    }

    function updateSelectAllState() {
      var rowCheckboxes = document.querySelectorAll('.row-checkbox');
      var allChecked = true;
      var someChecked = false;
      var selectedCount = 0;

      for (var i = 0; i < rowCheckboxes.length; i++) {
        if (rowCheckboxes[i].checked) {
          someChecked = true;
          selectedCount++;
        } else {
          allChecked = false;
        }
      }

      selectAllCheckbox.checked = allChecked && rowCheckboxes.length > 0;
      selectAllCheckbox.indeterminate = someChecked && !allChecked;
      if (selectionCountEl) {
        selectionCountEl.textContent = selectedCount + ' selecionado(s)';
      }
      if (clearSelectionBtn) {
        clearSelectionBtn.disabled = selectedCount === 0;
      }
    }

    selectAllCheckbox.addEventListener('change', function() {
      var rowCheckboxes = document.querySelectorAll('.row-checkbox');
      for (var i = 0; i < rowCheckboxes.length; i++) {
        rowCheckboxes[i].checked = selectAllCheckbox.checked;
        var row = rowCheckboxes[i].closest('tr');
        if (row) {
          if (selectAllCheckbox.checked) {
            row.classList.add('selected');
          } else {
            row.classList.remove('selected');
          }
        }
      }
      updateSelectAllState();
    });

    if (clearSelectionBtn) {
      clearSelectionBtn.addEventListener('click', function() {
        var rowCheckboxes = document.querySelectorAll('.row-checkbox');
        for (var i = 0; i < rowCheckboxes.length; i++) {
          rowCheckboxes[i].checked = false;
          var row = rowCheckboxes[i].closest('tr');
          if (row) row.classList.remove('selected');
        }
        updateSelectAllState();
      });
    }

    // ===== FILTRO POR COLUNA =====
    function getColumnValue(row, columnKey) {
      // REGRA: este switch deve casar com data-column no <th>.
      switch (columnKey) {
        case 'status': return row.status;
        case 'nufin': return String(row.nufin);
        case 'nunota': return String(row.nunota);
        case 'codparc': return String(row.codparc);
        case 'parceiro': return row.parceiro;
        case 'tipo': return row.tipo;
        case 'vencimento': return row.vencimento;
        case 'negociacao': return row.negociacao;
        case 'dhbaixa': return row.dhbaixa || '-';
        case 'valor':
          return (row.recdesp === 'Rec' ? '+R$ ' : '-R$ ') + formatCurrency(row.valor);
        case 'recdesp': return row.recdesp;
        case 'natureza': return row.natureza;
        case 'descricao': return row.descricao;
        case 'origem': return row.origem;
        default: return '';
      }
    }

    function getUniqueValues(columnKey) {
      var unique = {};
      for (var i = 0; i < mockData.length; i++) {
        var value = getColumnValue(mockData[i], columnKey);
        if (!unique[value]) unique[value] = true;
      }
      var values = [];
      for (var key in unique) {
        if (unique.hasOwnProperty(key)) values.push(key);
      }
      return values;
    }

    function ensureFilterState(columnKey, values) {
      if (!columnFilters[columnKey]) {
        var selected = {};
        for (var i = 0; i < values.length; i++) {
          selected[values[i]] = true;
        }
        columnFilters[columnKey] = { selected: selected, sort: 'asc', search: '' };
      } else {
        for (var j = 0; j < values.length; j++) {
          if (columnFilters[columnKey].selected[values[j]] === undefined) {
            columnFilters[columnKey].selected[values[j]] = true;
          }
        }
      }
    }

    function getSortedValues(values, sort) {
      var list = values.slice();
      list.sort(function(a, b) {
        var aVal = a.toLowerCase();
        var bVal = b.toLowerCase();
        if (aVal < bVal) return sort === 'desc' ? 1 : -1;
        if (aVal > bVal) return sort === 'desc' ? -1 : 1;
        return 0;
      });
      return list;
    }

    function renderFilterList(columnKey) {
      var values = getUniqueValues(columnKey);
      ensureFilterState(columnKey, values);
      var filter = columnFilters[columnKey];
      var sortedValues = getSortedValues(values, filter.sort);
      var searchText = filter.search.toLowerCase();
      var html = '';

      for (var i = 0; i < sortedValues.length; i++) {
        var value = sortedValues[i];
        if (searchText && value.toLowerCase().indexOf(searchText) === -1) continue;
        var checked = filter.selected[value] ? ' checked' : '';
        html += '<label class="column-filter-item">' +
          '<input type="checkbox" class="column-filter-checkbox" data-value="' + value + '"' + checked + '>' +
          '<span>' + value + '</span>' +
          '</label>';
      }

      columnFilterList.innerHTML = html;
      var checkboxes = columnFilterList.querySelectorAll('.column-filter-checkbox');
      for (var j = 0; j < checkboxes.length; j++) {
        checkboxes[j].addEventListener('change', function() {
          var val = this.getAttribute('data-value');
          columnFilters[columnKey].selected[val] = this.checked;
          applyColumnFilters();
        });
      }
    }

    function applyColumnFilters() {
      filteredData = mockData.filter(function(row) {
        for (var key in columnFilters) {
          if (!columnFilters.hasOwnProperty(key)) continue;
          var value = getColumnValue(row, key);
          if (!columnFilters[key].selected[value]) {
            return false;
          }
        }
        return true;
      });
      state.totalCount = filteredData.length;
      state.currentPage = 1;
      updatePagination();
      renderTable();
    }

    function openColumnFilter(headerEl, columnKey) {
      activeFilterHeader = headerEl;
      activeFilterColumn = columnKey;
      renderFilterList(columnKey);
      columnFilterSearch.value = columnFilters[columnKey].search || '';
      columnFilterDropdown.classList.add('open');

      var rect = headerEl.getBoundingClientRect();
      var dropdownWidth = columnFilterDropdown.offsetWidth || 240;
      var left = rect.left + window.scrollX;
      var top = rect.bottom + window.scrollY + 6;
      if (left + dropdownWidth > window.innerWidth) {
        left = window.innerWidth - dropdownWidth - 8;
      }
      if (left < 8) left = 8;
      columnFilterDropdown.style.left = left + 'px';
      columnFilterDropdown.style.top = top + 'px';
    }

    function closeColumnFilter() {
      activeFilterColumn = null;
      activeFilterHeader = null;
      columnFilterDropdown.classList.remove('open');
    }

    function initColumnFilters() {
      var headerCells = document.querySelectorAll('th[data-column] .table-header-cell');
      for (var i = 0; i < headerCells.length; i++) {
        headerCells[i].addEventListener('click', function(e) {
          var th = this.closest('th');
          if (!th || !th.dataset.column) return;
          if (e.target.classList.contains('resize-handle')) return;
          e.stopPropagation();
          if (activeFilterColumn === th.dataset.column && columnFilterDropdown.classList.contains('open')) {
            closeColumnFilter();
            return;
          }
          openColumnFilter(th, th.dataset.column);
        });
      }

      columnFilterDropdown.addEventListener('click', function(e) {
        e.stopPropagation();
      });

      document.addEventListener('click', function() {
        if (columnFilterDropdown.classList.contains('open')) {
          closeColumnFilter();
        }
      });

      columnFilterSearch.addEventListener('input', function() {
        if (!activeFilterColumn) return;
        columnFilters[activeFilterColumn].search = columnFilterSearch.value;
        renderFilterList(activeFilterColumn);
      });

      var sortButtons = columnFilterDropdown.querySelectorAll('[data-sort]');
      for (var j = 0; j < sortButtons.length; j++) {
        sortButtons[j].addEventListener('click', function() {
          if (!activeFilterColumn) return;
          columnFilters[activeFilterColumn].sort = this.getAttribute('data-sort');
          renderFilterList(activeFilterColumn);
        });
      }

      var selectButtons = columnFilterDropdown.querySelectorAll('[data-select]');
      for (var k = 0; k < selectButtons.length; k++) {
        selectButtons[k].addEventListener('click', function() {
          if (!activeFilterColumn) return;
          var values = getUniqueValues(activeFilterColumn);
          var mode = this.getAttribute('data-select');
          for (var i2 = 0; i2 < values.length; i2++) {
            columnFilters[activeFilterColumn].selected[values[i2]] = mode === 'all';
          }
          renderFilterList(activeFilterColumn);
          applyColumnFilters();
        });
      }
    }

    // ===== RESIZE DE COLUNAS =====
    function initColumnResize() {
      var resizeHandles = document.querySelectorAll('.resize-handle');

      for (var i = 0; i < resizeHandles.length; i++) {
        (function(handle) {
          var isResizing = false;
          var startX = 0;
          var startWidth = 0;
          var th = null;

          handle.addEventListener('mousedown', function(e) {
            isResizing = true;
            th = handle.parentElement;
            startX = e.pageX;
            startWidth = th.offsetWidth;
            handle.classList.add('active');
            document.body.style.cursor = 'col-resize';
            document.body.style.userSelect = 'none';
            e.preventDefault();
          });

          document.addEventListener('mousemove', function(e) {
            if (!isResizing) return;
            var width = startWidth + (e.pageX - startX);
            if (width >= 50) {
              th.style.width = width + 'px';
            }
          });

          document.addEventListener('mouseup', function() {
            if (isResizing) {
              isResizing = false;
              handle.classList.remove('active');
              document.body.style.cursor = '';
              document.body.style.userSelect = '';
            }
          });
        })(resizeHandles[i]);
      }
    }

    // ===== EVENT LISTENERS =====
    btnFirst.addEventListener('click', goToFirst);
    btnPrev.addEventListener('click', goToPrev);
    btnNext.addEventListener('click', goToNext);
    btnLast.addEventListener('click', goToLast);

    pageInput.addEventListener('change', function() {
      var page = parseInt(pageInput.value);
      if (!isNaN(page)) {
        goToPage(page);
      }
    });

    pageSizeSelect.addEventListener('change', function() {
      state.pageSize = parseInt(pageSizeSelect.value);
      state.currentPage = 1;
      updatePagination();
      renderTable();
    });

    // ===== ATALHOS DE TECLADO =====
    document.addEventListener('keydown', function(e) {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') return;

      if (e.altKey) {
        switch (e.key) {
          case 'ArrowLeft':
            e.preventDefault();
            goToPrev();
            break;
          case 'ArrowRight':
            e.preventDefault();
            goToNext();
            break;
          case 'Home':
            e.preventDefault();
            goToFirst();
            break;
          case 'End':
            e.preventDefault();
            goToLast();
            break;
        }
      }
    });

    // ===== INICIALIZAÇÃO =====
    // APRENDIDO: na versão com JX, carregar dados antes de renderizar.
    function init() {
      state.totalCount = filteredData.length;
      updatePagination();
      renderTable();
      initColumnResize();
      initColumnFilters();
      console.log('Dashboard Financeiro - ES5 carregado!');
      console.log('Total de registros: ' + mockData.length);
      console.log('Atalhos: Alt+← (anterior), Alt+→ (próxima), Alt+Home (primeira), Alt+End (última)');
    }

    init();
  </script>

</body>
</html>